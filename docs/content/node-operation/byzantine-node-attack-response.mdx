---
title: Byzantine node attack response
sidebar_title: Byzantine attack response
description: How to respond to a byzantine node attack on the network
---

Flow, like any blockchain, forms an open decentralized peer-to-peer network between all the nodes of the network.
Hence, there exists an attack vector where one (or more than one) of the nodes is malicious (in other words byzantine) and intentionally tries to harm the network.
There exist several protections within the node software to deal with invalid messages - checking message signatures, checking message payload etc. are just some of them.
These protections guard the network against attacks. However, there could still be a byzantine node that spams the other nodes in the network with invalid data at volumes that are intended to impact node performance.
While this will not compromise the security of the network it could impact network liveness.

This guide explains how to detect such a node and what actions you should take a node operator to deal with such byzantine nodes.

Responding to an attack from a byzantine node requires the following:

1. Immediate action to blocking network traffic routed from the byzantine node to your node.
2. Raising a governance FLIP to remove the node from the network as described in this [FLIP](https://github.com/onflow/flips/blob/main/governance/20230105-identify-errant-node.md).
3. A service account transaction to set the node weight to 0.

This guide focuses on the first action.

## Admin command

Flow nodes have an admin server which exposes a simple REST API for interacting with the node. See the [README](https://github.com/onflow/flow-go/blob/master/admin/README.md) for some useful examples.
It is disabled by default.

### Enable the admin server

To enable to admin server,

1. Add the following option to the docker parameters.
```
--admin-addr=localhost:9002
```

> Note: The port does not has to be 9002 and you can choose any free port

> ⚠️ Do NOT expose the port outside the machine and always use <b>localhost</b>:port

2. Reboot the node to apply the new setting. You can then verify it’s logging into the machine via ssh and running,

```
curl localhost:9002
```

This should return a json response message as below.
```
{"code":5,"message":"Not Found","details":[]}
```

If you instead get a connection rejected message then it’s not configured correctly.

## Detecting a byzantine node

The node will log any message any suspicious message with the label `"suspicious":true` along with the sender's node ID.

For example,
```
{"level":"error","node_role":"verification",
"node_id":"aaa4bd649d08ecb5afb7023a0c5e8bb10ce56659399665da8cc9d517e7982fff",
"component":"connection_gater","peer_id":"QmaPwhw324ghiLcFRQXSzYfYFht7mVNvLArH3QaXKQmAnk",
"remote_address":"...",
"error":"failed to get identity of unknown peer with peer id QmaPwhw324ghiLcFRQXSzYfYFht7mVNvLArH3QaXKQmAnk",
"local_address":"...",
"suspicious":true,
"time":"2023-02-02T05:41:12.764002432Z",
"message":"rejected inbound connection"}
```

## Reporting the byzantine node

Report the suspicious node on Discord on the `#flow-validators` channel.
All other node operators will be informed about the suspicious node via that channel.

## Blocking a byzantine node

Once a consensus is reached about the suspicious node on Discord, the suspicious node can be blocked using the admin command.

```
curl localhost: 9002/admin/run_command \
-H 'Content-Type: application/json' \
-d '{"commandName": "set-config","data": {"network-id-provider-blocklist": ["<suspcious node id>"]}}
```


After blocking the node, all traffic coming from the node will be rejected and you should no longer see any logs about that node ID.
