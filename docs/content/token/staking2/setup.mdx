---
title: Configure an Account to Receive Locked FLOW
sidebar_title: Account Setup
---

<Callout type="warning">

  This guide is for custody providers or wallet providers to create user accounts 
  that can hold locked tokens from the Flow token sale.
  If you already have an account and wish to stake tokens, see other sections of the staking docs.

</Callout>

# Introduction

This guide covers the technical integration required for custody providers to create
accounts that store locked tokens for users.

Every user who holds locked tokens gets two accounts.

- **Account One - Shared Account:** This account is shared between the Flow token admin and the user.
The user's key will have weight 900 and the token admin's key will have weight 100.
Therefore, any transactions that directly access this account need to be signed by both parties.
The locked tokens are stored in this account and the token admin has the authority to unlock
tokens as outlined by the vesting schedule. This account also manages access to the staking
and delegating functionality that a user signs up for.
- **Account Two - Unlocked Account:** This account is completely controlled by the user.
It includes an object that manages access to the functionality contained in the shared account.
The user submits token withdrawal and staking transactions with this account.

# Setup

To enable your custody account to create accounts with locked tokens, you must
run the transaction

`lockedTokens/admin/custody_setup_account_creator.cdc`

Transaction arguments:

None.

This transaction creates an `AccountCreator` object and stores it in the custody provider's account.
It also publishes a capability that allows the token admin to give the custody provider 
the authority to register locked token accounts.

# Account Creation

When a custody provider uses these transactions, they must also ensure that 
the token admin knows which account addresses map to which users. This is so 
the token admin knows how much to pay to each locked account
and how many tokens to unlock via the vesting schedule.

## 1. Creating Both Accounts for the user

If your user does not have a regular account created for them yet, you must 
create both accounts in a single transaction.

`lockedTokens/admin/custody_create_shared_accounts.cdc`

Transaction arguments:

| Argument                  | Type    | Purpose |
|---------------------------|---------|---------|
| **partialAdminPublicKey** | [UInt8] | The public key of the token admin. Must be Weight: 100 |
| **partialUserPublicKey**  | [UInt8] | The public key of the user. Must be Weight: 900 |
| **fullUserPublicKey**     | [UInt8] | The public key of the user. Must be Weight: 1000 |


## 2. Creating the Shared account for a user who already has a personal account

If your user already has a personal account allocated to them, you can run a transaction
that creates the shared account and gives their existing account the capability
to interact with their locked tokens. 

<Callout type="warning">

  This transaction **MUST** also be signed and authorized by the existing user account.
  It needs this because it needs to have access to the user's private storage and Authorized access.

</Callout>

`lockedTokens/admin/custody_create_only_shared_account.cdc`

Transaction arguments:

| Argument                  | Type    | Purpose |
|---------------------------|---------|---------|
| **partialAdminPublicKey** | [UInt8] | The public key of the token admin. Must be Weight: 100 |
| **partialUserPublicKey**  | [UInt8] | The public key of the user. Must be Weight: 900 |


Both transactions generally perform the same actions:

1. Create the shared account and add the partial public keys to the account.
2. Create the Locked Token Manager object in the shared account.
3. Create the Token Holder object and store it in the user account. This object
is what the user interacts with to withdraw unlocked tokens and perform staking actions.
4. Register the new accounts with the token admin account so that 
it can receive locked tokens from the vesting schedule.
5. Override the default Flow Token receiver to mark received tokens as unlocked.
6. Create a different Flow Token receiver that the token admin account uses to deposit locked tokens.





